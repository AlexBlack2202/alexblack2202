<!doctype html><html lang="en" data-palette="blue"
   data-mode="dark">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Deep Learning based Multiple Human Pose Estimation using OpenCV - Phạm Duy Tùng Machine Learning Blog</title><link rel="apple-touch-icon" href="/images/icons/icon-180x180.png" sizes="180x180">
<link rel="icon" href="/images/icons/icon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/images/icons/icon-16x16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/images/icons/favicon.ico">
<link rel="manifest" href="/manifest.json">
<meta name="keywords" content="" />
<meta name="description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation." /><meta name="robots" content="index, follow" /><meta itemprop="name" content="Deep Learning based Multiple Human Pose Estimation using OpenCV">
<meta itemprop="description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation."><meta itemprop="datePublished" content="2018-10-05T00:19:00+03:00" />
<meta itemprop="dateModified" content="2018-10-05T00:19:00+03:00" />
<meta itemprop="wordCount" content="1473">
<meta itemprop="keywords" content="Machine learning,Deeplearning,multiple pose estimation," /><meta property="og:title" content="Deep Learning based Multiple Human Pose Estimation using OpenCV" />
<meta property="og:description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/2018-10-05-deep-learning-base-multiple-human-pose-estimation/" /><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2018-10-05T00:19:00+03:00" />
<meta property="article:modified_time" content="2018-10-05T00:19:00+03:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deep Learning based Multiple Human Pose Estimation using OpenCV"/>
<meta name="twitter:description" content="Ở bài viết này, chúng ta đề cập đến vấn đề sử dụng Deep Neural Net trong việc thực hiện Human Pose Estimation."/>
<meta property="og:image" content="/images/logo.png"/>
  <meta name="twitter:image" content="/images/logo.png"/><link rel="stylesheet" href="/css/main.min.507afbe6e4670fa3e961a0b35816b5daeb36029866fd6bd7b9d7871fcf88faa5.css" integrity="sha256-UHr75uRnD6PpYaCzWBa12us2Aphm/WvXudeHH8&#43;I&#43;qU=" crossorigin="anonymous"><link rel="stylesheet" href="/css/katex.min.d080a89e03e1eb850f547d835c186b4273f69879aa497eb8b0e88c1578bf1f0b.css" integrity="sha256-0ICongPh64UPVH2DXBhrQnP2mHmqSX64sOiMFXi/Hws=" crossorigin="anonymous">
<link rel="stylesheet" href="/css/viewer.min.3d228794bcedbbfa0412beb8fbc1ec6973202945e42af7004f742a4d7bd620ab.css" integrity="sha256-PSKHlLztu/oEEr64&#43;8HsaXMgKUXkKvcAT3QqTXvWIKs=" crossorigin="anonymous"></head>
  <body><script>const items=['mode','palette'];items.forEach(function(a){const b=localStorage.getItem('hbs-'+a);b&&document.body.parentElement.setAttribute('data-'+a,b)})</script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top">
  <div class="container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <i class="fas fa-bars"></i>
    </button><a class="navbar-brand flex-grow-1 flex-lg-grow-0 text-center text-lg-start mx-auto me-lg-3" href="/"><img class="logo" alt="Logo" src="/images/logo.webp" loading="lazy"
   width="400" height="400"
   />
HOME
    </a>
    <div class="offcanvas offcanvas-bottom surface" tabindex="-1" id="offcanvasSocialShare" aria-labelledby="offcanvasSocialShare">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Share</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body">
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button"
      target="_blank" href="https://twitter.com/intent/tweet?title=Deep%20Learning%20based%20Multiple%20Human%20Pose%20Estimation%20using%20OpenCV&url=%2fblog%2f2018-10-05-deep-learning-base-multiple-human-pose-estimation%2f">
      <i class="fab fa-fw fa-twitter"></i> Twitter
    </a>
    <a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button"
      target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=%2fblog%2f2018-10-05-deep-learning-base-multiple-human-pose-estimation%2f">
      <i class="fab fa-fw fa-facebook-f"></i> Facebook
    </a>
  </div>
</div>
    <button class="navbar-settings" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSettings"
  aria-controls="offcanvasSettings" aria-label="Toggle settings">
  <i class="fas fa-ellipsis-v"></i>
</button>

<div class="offcanvas offcanvas-end surface h-100" tabindex="-1" id="offcanvasSettings" aria-labelledby="offcanvasSettings">
  <div class="offcanvas-header">
    <h3 class="offcanvas-title">Settings</h3>
    <button type="button" class="btn btn-sm btn-outline-primary" data-bs-dismiss="offcanvas" aria-label="Close">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div class="offcanvas-body d-flex flex-column">



<section class="setting">
  <form class="font-size-switcher-form row">
    <div class="col-auto">
      <label for="fontSize" class="form-label"><i class="fas fa-fw fa-font"></i> Font Size</label>
    </div>
    <div class="col-auto ms-auto">
      <input type="range" class="form-range" min="-2" max="2" id="fontSize">
    </div>
  </form>
</section>


<section class="setting palettes">
  <form class="row">
    <div class="col-auto">
      <label><i class="fas fa-fw fa-palette"></i> Palette</label>
    </div>
    <div class="col-auto ms-auto">
      <a id="btnPalette" class="btn btn-sm btn-outline-primary" role="button" aria-label="palettePicker">
        <i class="fas fa-eye-dropper"></i>
      </a>
    </div>
  </form>
  <div class="mt-2 d-flex justify-content-between visually-hidden" id="palettePicker"><button type="button" id="palette-blue" aria-label="Blue"
        class="btn btn-sm w-100 palette" data-palette="blue">
      </button><button type="button" id="palette-blue-gray" aria-label="Blue Gray"
        class="btn btn-sm w-100 palette" data-palette="blue-gray">
      </button><button type="button" id="palette-brown" aria-label="Brown"
        class="btn btn-sm w-100 palette" data-palette="brown">
      </button><button type="button" id="palette-cyan" aria-label="Cyan"
        class="btn btn-sm w-100 palette" data-palette="cyan">
      </button><button type="button" id="palette-green" aria-label="Green"
        class="btn btn-sm w-100 palette" data-palette="green">
      </button><button type="button" id="palette-indigo" aria-label="Indigo"
        class="btn btn-sm w-100 palette" data-palette="indigo">
      </button><button type="button" id="palette-orange" aria-label="Orange"
        class="btn btn-sm w-100 palette" data-palette="orange">
      </button><button type="button" id="palette-pink" aria-label="Pink"
        class="btn btn-sm w-100 palette" data-palette="pink">
      </button><button type="button" id="palette-purple" aria-label="Purple"
        class="btn btn-sm w-100 palette" data-palette="purple">
      </button><button type="button" id="palette-red" aria-label="Red"
        class="btn btn-sm w-100 palette" data-palette="red">
      </button><button type="button" id="palette-teal" aria-label="Teal"
        class="btn btn-sm w-100 palette" data-palette="teal">
      </button><button type="button" id="palette-yellow" aria-label="Yellow"
        class="btn btn-sm w-100 palette" data-palette="yellow">
      </button></div>
</section>
<section class="setting actions d-flex justify-content-around mt-auto overflow-auto">
  <a role="button" class="action action-go-back" href="javascript: window.history.back();">
    <span class="action-icon"><i class="fas fa-2x fa-arrow-left"></i></span> Go back
  </a>
  <a role="button" class="action action-reload-page">
    <span class="action-icon"><i class="fas fa-2x fa-redo-alt"></i></span> Reload
  </a>
  <a role="button" class="action action-copy-url">
    <span class="action-icon"><i class="fas fa-2x fa-link"></i></span> Copy URL
  </a><a class="action action-social-share" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSocialShare"
    aria-controls="offcanvasSocialShare" aria-label="Toggle social share">
    <span class="action-icon"><i class="fas fa-2x fa-share-alt"></i></span> Share
  </a></section>

</div>
</div>

    <div class="collapse navbar-collapse" tabindex="-1" id="navbarSupportedContent" aria-labelledby="navbarSupportedContent">
      <form class="search-bar my-1" action="/search">
  <div class="input-group input-group-sm">
    <span class="btn btn-search disabled position-absolute left-0"><i class="fas fa-fw fa-search"></i></span>
    <input class="form-control rounded-pill" name="q" type="search" aria-label="Search">
  </div>
</form>
      <ul class="navbar-nav ms-auto"><li class="nav-item">
          <a class="nav-link" href="/series/">
            <i class="fas fa-fw fa-columns"></i>Series
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/archives/">
            <i class="fas fa-fw fa-file-archive"></i>Archives
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/categories/">
            <i class="fas fa-fw fa-folder"></i>Categories
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/tools/">
            <i class="fas fa-fw fa-folder"></i>Tools
          </a>
        </li><li class="nav-item">
          <a class="nav-link" href="/tags/">
            <i class="fas fa-fw fa-tags"></i>Tags
          </a>
        </li><li class="nav-item dropdown">
          <a class="nav-link" id="navbarDropdownSupport" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-fw fa-chevron-circle-down"></i>Support
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdownSupport"><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Repository
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Discussions
              </a>
            </li><li>
              <a class="dropdown-item"
                href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">
                Features Request
              </a>
            </li><li><hr class="dropdown-divider"></li><li>
              <a class="dropdown-item"
                href="/faq/">
                FAQs
              </a>
            </li></ul>
        </li></ul>
    </div>
  </div>
</nav>
</header>
<main role="main" class="container">
      <div class="row content">
<div class="col-lg-8">
  <div class="container"><nav class="row card component" aria-label="breadcrumb">
  <div class="card-body">
    <ol class="breadcrumb "><li class="breadcrumb-item"><a href="/">Home</a></li><li class="breadcrumb-item"><a href="/blog/">Blogs</a></li><li class="breadcrumb-item active">Deep Learning Based Multiple Human Pose Estimation Using OpenCV</li></ol>
  </div>
</nav>
<div class="post-panel-wrapper">
  <div class="d-flex flex-column component rounded post-panel">
    
    <a class="action action-panel-toggler" role="button" title="Panel toggler">
      <i class="fas fa-fw fa-chevron-circle-down"></i>
    </a>
    <a id="sidebarToggler" class="action d-none d-lg-block" role="button" title="Sidebar toggler">
  <i class="fas fa-fw fa-expand-alt" data-fa-transform="rotate-45"></i>
</a>

    

    
    
    <a class="action" href="#post-comments" role="button" aria-label="Comments" title="Comments">
  <i class="fas fa-fw fa-comments"></i>
</a>
    <a class="action" href="#postTOC" aria-controls="Table of contents" role="button" title="Table of contents">
  <i class="fas fa-fw fa-list-alt"></i>
</a>
    
  </div>
</div>
<article class="row card component mb-4 post">
  <div class="card-header ">
    <h1 class="card-title post-title">Deep Learning Based Multiple Human Pose Estimation Using OpenCV
</h1>
  </div>
  <div class="card-body"><div class="post-meta">
  <span class="post-date" title="created on 2018-10-05 04:19:00 &#43;0700 &#43;07.">
    Oct 5, 2018
  </span><span class="post-reading-time">
    7 min read
  </span><span class="post-taxonomies"><a href="/tags/machine-learning/" class="badge post-taxonomy">Machine learning</a><a href="/tags/deeplearning/" class="badge post-taxonomy">Deeplearning</a><a href="/tags/multiple-pose-estimation/" class="badge post-taxonomy">multiple pose estimation</a></span>
</div>
<div class="post-content mb-3"><h2 id="lời-mở-đầu">Lời mở đầu<a class="anchor ms-1" href="#lời-mở-đầu"><i class="fas fa-link"></i></a></h2>
<p>Lưu ý: Để sử dụng được các mô hình trong bài viết này, bạn phải sử dụng phiên bản opencv &gt; 3.4.1.</p>
<p>Ở bài viết trước, chúng ta đã tìm hiểu cách thức rút trích khung xương sử dụng DNN và đã áp dụng thành công trên ảnh có chứa 1 đối tượng người. Trong bài viết này, chúng ta sẽ thực hiện áp dụng mô hình cho bài toán có nhiều người trong cùng 1 bức ảnh.</p>
<h2 id="sử-dụng-pretrain-model-trong-bài-toán-multiple-pose-estimation">Sử dụng pretrain model trong bài toán multiple Pose Estimation<a class="anchor ms-1" href="#sử-dụng-pretrain-model-trong-bài-toán-multiple-pose-estimation"><i class="fas fa-link"></i></a></h2>
<p>Trong bài viết này, chúng ta tiếp tục sử dụng mô hình MPI để dò tìm các điểm đặc trưng của con người và rút ra mô hình khung xương. Kết quả trả về của thuật toán gồm 15 đặc trưng như bên dưới.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="ln">1</span><span class="n">Head</span> <span class="err">–</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Neck</span> <span class="err">–</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Right</span> <span class="n">Shoulder</span> <span class="err">–</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Right</span> <span class="n">Elbow</span> <span class="err">–</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Right</span> <span class="n">Wrist</span> <span class="err">–</span> <span class="mi">4</span><span class="p">,</span>
<span class="ln">2</span><span class="n">Left</span> <span class="n">Shoulder</span> <span class="err">–</span> <span class="mi">5</span><span class="p">,</span> <span class="n">Left</span> <span class="n">Elbow</span> <span class="err">–</span> <span class="mi">6</span><span class="p">,</span> <span class="n">Left</span> <span class="n">Wrist</span> <span class="err">–</span> <span class="mi">7</span><span class="p">,</span> <span class="n">Right</span> <span class="n">Hip</span> <span class="err">–</span> <span class="mi">8</span><span class="p">,</span>
<span class="ln">3</span><span class="n">Right</span> <span class="n">Knee</span> <span class="err">–</span> <span class="mi">9</span><span class="p">,</span> <span class="n">Right</span> <span class="n">Ankle</span> <span class="err">–</span> <span class="mi">10</span><span class="p">,</span> <span class="n">Left</span> <span class="n">Hip</span> <span class="err">–</span> <span class="mi">11</span><span class="p">,</span> <span class="n">Left</span> <span class="n">Knee</span> <span class="err">–</span> <span class="mi">12</span><span class="p">,</span>
<span class="ln">4</span><span class="n">Left</span> <span class="n">Ankle</span> <span class="err">–</span> <span class="mi">13</span><span class="p">,</span> <span class="n">Chest</span> <span class="err">–</span> <span class="mi">14</span><span class="p">,</span> <span class="n">Background</span> <span class="err">–</span> <span class="mi">15</span>
</code></pre></div><p>Áp dụng mô hình với ảnh của nhóm T-ARA.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="ln"> 1</span><span class="kn">import</span> <span class="nn">cv2</span>
<span class="ln"> 2</span>
<span class="ln"> 3</span><span class="n">nPoints</span> <span class="o">=</span> <span class="mi">15</span>
<span class="ln"> 4</span><span class="n">POSE_PAIRS</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">]</span> <span class="p">]</span>
<span class="ln"> 5</span>
<span class="ln"> 6</span><span class="n">protoFile</span> <span class="o">=</span> <span class="s2">&#34;pose/mpi/pose_deploy_linevec.prototxt&#34;</span>
<span class="ln"> 7</span><span class="n">weightsFile</span> <span class="o">=</span> <span class="s2">&#34;pose/mpi/pose_iter_160000.caffemodel&#34;</span>
<span class="ln"> 8</span>
<span class="ln"> 9</span><span class="n">net</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">readNetFromCaffe</span><span class="p">(</span><span class="n">protoFile</span><span class="p">,</span> <span class="n">weightsFile</span><span class="p">)</span>
<span class="ln">10</span>
<span class="ln">11</span><span class="n">frame</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&#34;tara1.jpg&#34;</span><span class="p">)</span>
<span class="ln">12</span>
<span class="ln">13</span><span class="n">inWidth</span> <span class="o">=</span> <span class="mi">368</span>
<span class="ln">14</span><span class="n">inHeight</span> <span class="o">=</span> <span class="mi">368</span>
<span class="ln">15</span> 
<span class="ln">16</span><span class="c1"># Prepare the frame to be fed to the network</span>
<span class="ln">17</span><span class="n">inpBlob</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">dnn</span><span class="o">.</span><span class="n">blobFromImage</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="n">inWidth</span><span class="p">,</span> <span class="n">inHeight</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">swapRB</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">crop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="ln">18</span> 
<span class="ln">19</span><span class="c1"># Set the prepared object as the input blob of the network</span>
<span class="ln">20</span><span class="n">net</span><span class="o">.</span><span class="n">setInput</span><span class="p">(</span><span class="n">inpBlob</span><span class="p">)</span>
<span class="ln">21</span>
<span class="ln">22</span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
</code></pre></div><p>Thử show lên vị trí vùng cổ trong hình.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="ln"> 1</span>
<span class="ln"> 2</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="ln"> 3</span><span class="n">probMap</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="ln"> 4</span><span class="n">probMap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">probMap</span><span class="p">,</span> <span class="p">(</span><span class="n">frameWidth</span><span class="p">,</span> <span class="n">frameHeight</span><span class="p">))</span>
<span class="ln"> 5</span>
<span class="ln"> 6</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="ln"> 7</span>
<span class="ln"> 8</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frameCopy</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="ln"> 9</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">probMap</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="ln">10</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img class="img-fluid" alt="Hình với điểm đặc trưng vùng đầu" src="/blog/2018-10-05-deep-learning-base-multiple-human-pose-estimation/multiple_pose_estimation_head_heatmap.png" loading="lazy"
  
   />

</p>
<p>Thử show lên hình điểm đặc trưng vùng cổ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="ln">1</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<span class="ln">2</span><span class="n">probMap</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="ln">3</span><span class="n">probMap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">probMap</span><span class="p">,</span> <span class="p">(</span><span class="n">frameWidth</span><span class="p">,</span> <span class="n">frameHeight</span><span class="p">))</span>
<span class="ln">4</span>
<span class="ln">5</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
<span class="ln">6</span>
<span class="ln">7</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frameCopy</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="ln">8</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">probMap</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="ln">9</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img class="img-fluid" alt="Hình với điểm đặc trưng vùng cổ" src="/blog/2018-10-05-deep-learning-base-multiple-human-pose-estimation/multiple_pose_estimation_neck_heatmap.png" loading="lazy"
  
   />

</p>
<p>Bằng một số phép biến đổi quen thuộc có sẵn trong opencv, chúng ta hoàn toàn có thể lấy được toạ độ của các điểm keypoint một cách dễ dàng.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="ln"> 1</span>
<span class="ln"> 2</span><span class="c1"># Find the Keypoints using Non Maximum Suppression on the Confidence Map</span>
<span class="ln"> 3</span><span class="k">def</span> <span class="nf">getKeypoints</span><span class="p">(</span><span class="n">probMap</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="ln"> 4</span>    
<span class="ln"> 5</span>    <span class="n">mapSmooth</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">GaussianBlur</span><span class="p">(</span><span class="n">probMap</span><span class="p">,(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="ln"> 6</span>
<span class="ln"> 7</span>    <span class="n">mapMask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">(</span><span class="n">mapSmooth</span><span class="o">&gt;</span><span class="n">threshold</span><span class="p">)</span>
<span class="ln"> 8</span>    <span class="n">keypoints</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln"> 9</span>    
<span class="ln">10</span>    <span class="c1">#find the blobs</span>
<span class="ln">11</span>    <span class="n">_</span><span class="p">,</span> <span class="n">contours</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">findContours</span><span class="p">(</span><span class="n">mapMask</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">RETR_TREE</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">CHAIN_APPROX_SIMPLE</span><span class="p">)</span>
<span class="ln">12</span>    
<span class="ln">13</span>    <span class="c1">#for each blob find the maxima</span>
<span class="ln">14</span>    <span class="k">for</span> <span class="n">cnt</span> <span class="ow">in</span> <span class="n">contours</span><span class="p">:</span>
<span class="ln">15</span>        <span class="n">blobMask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">mapMask</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="ln">16</span>        <span class="n">blobMask</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">fillConvexPoly</span><span class="p">(</span><span class="n">blobMask</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="ln">17</span>        <span class="n">maskedProbMap</span> <span class="o">=</span> <span class="n">mapSmooth</span> <span class="o">*</span> <span class="n">blobMask</span>
<span class="ln">18</span>        <span class="n">_</span><span class="p">,</span> <span class="n">maxVal</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">maxLoc</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">minMaxLoc</span><span class="p">(</span><span class="n">maskedProbMap</span><span class="p">)</span>
<span class="ln">19</span>        <span class="n">keypoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">maxLoc</span> <span class="o">+</span> <span class="p">(</span><span class="n">probMap</span><span class="p">[</span><span class="n">maxLoc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">maxLoc</span><span class="p">[</span><span class="mi">0</span><span class="p">]],))</span>
<span class="ln">20</span>
<span class="ln">21</span>    <span class="k">return</span> <span class="n">keypoints</span>
<span class="ln">22</span>
<span class="ln">23</span>
<span class="ln">24</span><span class="n">detected_keypoints</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln">25</span><span class="n">keypoints_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="ln">26</span><span class="n">keypoint_id</span> <span class="o">=</span> <span class="mi">0</span>
<span class="ln">27</span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="ln">28</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nPoints</span><span class="p">):</span>
<span class="ln">29</span>    <span class="n">probMap</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="ln">30</span>    <span class="n">probMap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">probMap</span><span class="p">,</span> <span class="p">(</span><span class="n">frameWidth</span><span class="p">,</span> <span class="n">frameHeight</span><span class="p">))</span>
<span class="ln">31</span>
<span class="ln">32</span>    <span class="n">keypoints</span> <span class="o">=</span> <span class="n">getKeypoints</span><span class="p">(</span><span class="n">probMap</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
<span class="ln">33</span>    <span class="n">keypoints_with_id</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln">34</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">keypoints</span><span class="p">)):</span>
<span class="ln">35</span>        <span class="n">keypoints_with_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keypoints</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">keypoint_id</span><span class="p">,))</span>
<span class="ln">36</span>        <span class="n">keypoints_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">keypoints_list</span><span class="p">,</span> <span class="n">keypoints</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
<span class="ln">37</span>        <span class="n">keypoint_id</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ln">38</span>
<span class="ln">39</span>    <span class="n">detected_keypoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keypoints_with_id</span><span class="p">)</span>
<span class="ln">40</span>
<span class="ln">41</span>
<span class="ln">42</span>
<span class="ln">43</span><span class="n">frameClone</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">frameCopy</span><span class="p">,</span><span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
<span class="ln">44</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nPoints</span><span class="p">):</span>
<span class="ln">45</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">detected_keypoints</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
<span class="ln">46</span>        <span class="n">cv2</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">frameClone</span><span class="p">,</span> <span class="n">detected_keypoints</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
<span class="ln">47</span>
<span class="ln">48</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">frameClone</span><span class="p">)</span> 
<span class="ln">49</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img class="img-fluid" alt="Hình toàn bộ điểm đặc trưng" src="/blog/2018-10-05-deep-learning-base-multiple-human-pose-estimation/multiple_pose_estimation_keypoint.jpg" loading="lazy"
  
   />

</p>
<p>Cuối cùng, chúng ta sẽ nối các điểm đặc trưng của các nhân vật thông qua thuật toán Part Affinity Heatmaps. Thuật toán này được đề xuất bởi nhóm tác giả Zhe Cao, Tomas Simon,Shih-En Wei, Yaser Sheikh thuộc phòng thí nghiệm The Robotics Institute trường đại học Carnegie Mellon. Các bạn có nhu cầu có thể tìm hiểu ở <a href="https://arxiv.org/pdf/1611.08050.pdf" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/1611.08050.pdf</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="ln">  1</span>
<span class="ln">  2</span><span class="n">mapIdx</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">],</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">],</span> <span class="p">[</span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">],</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">31</span><span class="p">],</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">],</span> <span class="p">[</span><span class="mi">34</span><span class="p">,</span><span class="mi">35</span><span class="p">],</span> <span class="p">[</span><span class="mi">36</span><span class="p">,</span><span class="mi">37</span><span class="p">],</span> <span class="p">[</span><span class="mi">38</span><span class="p">,</span><span class="mi">39</span><span class="p">],</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">],</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">]]</span>
<span class="ln">  3</span>
<span class="ln">  4</span>
<span class="ln">  5</span>
<span class="ln">  6</span><span class="n">colors</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span>
<span class="ln">  7</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span>
<span class="ln">  8</span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">],</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="ln">  9</span><span class="c1"># Find valid connections between the different joints of a all persons present</span>
<span class="ln"> 10</span><span class="k">def</span> <span class="nf">getValidPairs</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
<span class="ln"> 11</span>    <span class="n">valid_pairs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln"> 12</span>    <span class="n">invalid_pairs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln"> 13</span>    <span class="n">n_interp_samples</span> <span class="o">=</span> <span class="mi">10</span>
<span class="ln"> 14</span>    <span class="n">paf_score_th</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="ln"> 15</span>    <span class="n">conf_th</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="ln"> 16</span>    <span class="c1"># loop for every POSE_PAIR</span>
<span class="ln"> 17</span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mapIdx</span><span class="p">)):</span>
<span class="ln"> 18</span>        <span class="c1"># A-&gt;B constitute a limb</span>
<span class="ln"> 19</span>        <span class="n">pafA</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapIdx</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="ln"> 20</span>        <span class="n">pafB</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">mapIdx</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="ln"> 21</span>        <span class="n">pafA</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">pafA</span><span class="p">,</span> <span class="p">(</span><span class="n">frameWidth</span><span class="p">,</span> <span class="n">frameHeight</span><span class="p">))</span>
<span class="ln"> 22</span>        <span class="n">pafB</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">pafB</span><span class="p">,</span> <span class="p">(</span><span class="n">frameWidth</span><span class="p">,</span> <span class="n">frameHeight</span><span class="p">))</span>
<span class="ln"> 23</span>
<span class="ln"> 24</span>
<span class="ln"> 25</span>        <span class="c1"># Find the keypoints for the first and second limb</span>
<span class="ln"> 26</span>        <span class="n">candA</span> <span class="o">=</span> <span class="n">detected_keypoints</span><span class="p">[</span><span class="n">POSE_PAIRS</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
<span class="ln"> 27</span>        <span class="n">candB</span> <span class="o">=</span> <span class="n">detected_keypoints</span><span class="p">[</span><span class="n">POSE_PAIRS</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
<span class="ln"> 28</span>        <span class="n">nA</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candA</span><span class="p">)</span>
<span class="ln"> 29</span>        <span class="n">nB</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">candB</span><span class="p">)</span>
<span class="ln"> 30</span>
<span class="ln"> 31</span>        <span class="c1"># fig=plt.figure(figsize=(8, 8))</span>
<span class="ln"> 32</span>
<span class="ln"> 33</span>        <span class="c1"># interp_coord = list(zip(np.linspace(candA[0][0], candB[0][0], num=n_interp_samples),</span>
<span class="ln"> 34</span>        <span class="c1">#                                     np.linspace(candA[0][1], candB[0][1], num=n_interp_samples)))</span>
<span class="ln"> 35</span>
<span class="ln"> 36</span>        <span class="c1"># frameClone1 = frameClone.copy() </span>
<span class="ln"> 37</span>        <span class="c1"># fig.add_subplot(1, 2, 1)</span>
<span class="ln"> 38</span>        
<span class="ln"> 39</span>        <span class="c1"># for xx in interp_coord:</span>
<span class="ln"> 40</span>        <span class="c1">#     cv2.circle(frameClone1,(int(xx[0]),int(xx[1])), 3, [0,0,255], -1, cv2.LINE_AA)</span>
<span class="ln"> 41</span>
<span class="ln"> 42</span>
<span class="ln"> 43</span>        <span class="c1"># plt.imshow(cv2.cvtColor(frameClone1, cv2.COLOR_BGR2RGB))</span>
<span class="ln"> 44</span>        <span class="c1"># plt.imshow(pafA, alpha=0.5)</span>
<span class="ln"> 45</span>
<span class="ln"> 46</span>        <span class="c1"># frameClone1 = frameClone.copy() </span>
<span class="ln"> 47</span>        <span class="c1"># fig.add_subplot(1, 2, 2)</span>
<span class="ln"> 48</span>        
<span class="ln"> 49</span>
<span class="ln"> 50</span>        
<span class="ln"> 51</span>
<span class="ln"> 52</span>        <span class="c1"># for xx in interp_coord:</span>
<span class="ln"> 53</span>        <span class="c1">#     cv2.circle(frameClone1,(int(xx[0]),int(xx[1])), 3, [0,0,255], -1, cv2.LINE_AA)</span>
<span class="ln"> 54</span>        
<span class="ln"> 55</span>        <span class="c1"># plt.imshow(cv2.cvtColor(frameClone1, cv2.COLOR_BGR2RGB))</span>
<span class="ln"> 56</span>        <span class="c1"># plt.imshow(pafB, alpha=0.5)</span>
<span class="ln"> 57</span>        <span class="c1"># plt.show()</span>
<span class="ln"> 58</span>
<span class="ln"> 59</span>
<span class="ln"> 60</span>
<span class="ln"> 61</span>        
<span class="ln"> 62</span>
<span class="ln"> 63</span>        <span class="c1"># If keypoints for the joint-pair is detected</span>
<span class="ln"> 64</span>        <span class="c1"># check every joint in candA with every joint in candB </span>
<span class="ln"> 65</span>        <span class="c1"># Calculate the distance vector between the two joints</span>
<span class="ln"> 66</span>        <span class="c1"># Find the PAF values at a set of interpolated points between the joints</span>
<span class="ln"> 67</span>        <span class="c1"># Use the above formula to compute a score to mark the connection valid</span>
<span class="ln"> 68</span>        
<span class="ln"> 69</span>        <span class="k">if</span><span class="p">(</span> <span class="n">nA</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">nB</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
<span class="ln"> 70</span>            <span class="n">valid_pair</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="ln"> 71</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nA</span><span class="p">):</span>
<span class="ln"> 72</span>                <span class="n">max_j</span><span class="o">=-</span><span class="mi">1</span>
<span class="ln"> 73</span>                <span class="n">maxScore</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="ln"> 74</span>                <span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
<span class="ln"> 75</span>                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nB</span><span class="p">):</span>
<span class="ln"> 76</span>                    <span class="c1"># Find d_ij</span>
<span class="ln"> 77</span>                    <span class="n">d_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">candB</span><span class="p">[</span><span class="n">j</span><span class="p">][:</span><span class="mi">2</span><span class="p">],</span> <span class="n">candA</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="mi">2</span><span class="p">])</span>
<span class="ln"> 78</span>                    <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">d_ij</span><span class="p">)</span>
<span class="ln"> 79</span>                    <span class="k">if</span> <span class="n">norm</span><span class="p">:</span>
<span class="ln"> 80</span>                        <span class="n">d_ij</span> <span class="o">=</span> <span class="n">d_ij</span> <span class="o">/</span> <span class="n">norm</span>
<span class="ln"> 81</span>                    <span class="k">else</span><span class="p">:</span>
<span class="ln"> 82</span>                        <span class="k">continue</span>
<span class="ln"> 83</span>                    <span class="c1"># Find p(u)</span>
<span class="ln"> 84</span>                    <span class="n">interp_coord</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">candA</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">candB</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_interp_samples</span><span class="p">),</span>
<span class="ln"> 85</span>                                            <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">candA</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">candB</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="n">n_interp_samples</span><span class="p">)))</span>
<span class="ln"> 86</span>                    <span class="c1"># Find L(p(u))</span>
<span class="ln"> 87</span>                    <span class="n">paf_interp</span> <span class="o">=</span> <span class="p">[]</span>
<span class="ln"> 88</span>                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">interp_coord</span><span class="p">)):</span>
<span class="ln"> 89</span>                        <span class="n">paf_interp</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">pafA</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">interp_coord</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">])),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">interp_coord</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]))],</span>
<span class="ln"> 90</span>                                           <span class="n">pafB</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">interp_coord</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">])),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">interp_coord</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]))]</span> <span class="p">])</span> 
<span class="ln"> 91</span>                    <span class="c1"># Find E</span>
<span class="ln"> 92</span>                    <span class="n">paf_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">paf_interp</span><span class="p">,</span> <span class="n">d_ij</span><span class="p">)</span>
<span class="ln"> 93</span>                    <span class="n">avg_paf_score</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">paf_scores</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">paf_scores</span><span class="p">)</span>
<span class="ln"> 94</span>                    
<span class="ln"> 95</span>                    <span class="c1"># Check if the connection is valid</span>
<span class="ln"> 96</span>                    <span class="c1"># If the fraction of interpolated vectors aligned with PAF is higher then threshold -&gt; Valid Pair  </span>
<span class="ln"> 97</span>                    <span class="k">if</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">paf_scores</span> <span class="o">&gt;</span> <span class="n">paf_score_th</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">n_interp_samples</span> <span class="p">)</span> <span class="o">&gt;</span> <span class="n">conf_th</span> <span class="p">:</span>
<span class="ln"> 98</span>                        <span class="k">if</span> <span class="n">avg_paf_score</span> <span class="o">&gt;</span> <span class="n">maxScore</span><span class="p">:</span>
<span class="ln"> 99</span>                            <span class="n">max_j</span> <span class="o">=</span> <span class="n">j</span>
<span class="ln">100</span>                            <span class="n">maxScore</span> <span class="o">=</span> <span class="n">avg_paf_score</span>
<span class="ln">101</span>                            <span class="n">found</span> <span class="o">=</span> <span class="mi">1</span>
<span class="ln">102</span>                <span class="c1"># Append the connection to the list</span>
<span class="ln">103</span>                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>            
<span class="ln">104</span>                    <span class="n">valid_pair</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valid_pair</span><span class="p">,</span> <span class="p">[[</span><span class="n">candA</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">candB</span><span class="p">[</span><span class="n">max_j</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">maxScore</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="ln">105</span>
<span class="ln">106</span>            <span class="c1"># Append the detected connections to the global list</span>
<span class="ln">107</span>            <span class="n">valid_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valid_pair</span><span class="p">)</span>
<span class="ln">108</span>
<span class="ln">109</span>            <span class="n">pprint</span><span class="p">(</span><span class="n">valid_pair</span><span class="p">)</span>
<span class="ln">110</span>        <span class="k">else</span><span class="p">:</span> <span class="c1"># If no keypoints are detected</span>
<span class="ln">111</span>            <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;No Connection : k = </span><span class="si">{}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<span class="ln">112</span>            <span class="n">invalid_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="ln">113</span>            <span class="n">valid_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
<span class="ln">114</span>    <span class="n">pprint</span><span class="p">(</span><span class="n">valid_pairs</span><span class="p">)</span>
<span class="ln">115</span>    <span class="k">return</span> <span class="n">valid_pairs</span><span class="p">,</span> <span class="n">invalid_pairs</span>
<span class="ln">116</span>
<span class="ln">117</span><span class="c1"># This function creates a list of keypoints belonging to each person</span>
<span class="ln">118</span><span class="c1"># For each detected valid pair, it assigns the joint(s) to a person</span>
<span class="ln">119</span><span class="c1"># It finds the person and index at which the joint should be added. This can be done since we have an id for each joint</span>
<span class="ln">120</span><span class="k">def</span> <span class="nf">getPersonwiseKeypoints</span><span class="p">(</span><span class="n">valid_pairs</span><span class="p">,</span> <span class="n">invalid_pairs</span><span class="p">):</span>
<span class="ln">121</span>    <span class="c1"># the last number in each row is the overall score </span>
<span class="ln">122</span>    <span class="n">personwiseKeypoints</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">))</span>
<span class="ln">123</span>
<span class="ln">124</span>    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mapIdx</span><span class="p">)):</span>
<span class="ln">125</span>        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">invalid_pairs</span><span class="p">:</span>
<span class="ln">126</span>            <span class="n">partAs</span> <span class="o">=</span> <span class="n">valid_pairs</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>
<span class="ln">127</span>            <span class="n">partBs</span> <span class="o">=</span> <span class="n">valid_pairs</span><span class="p">[</span><span class="n">k</span><span class="p">][:,</span><span class="mi">1</span><span class="p">]</span>
<span class="ln">128</span>            <span class="n">indexA</span><span class="p">,</span> <span class="n">indexB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">POSE_PAIRS</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
<span class="ln">129</span>
<span class="ln">130</span>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_pairs</span><span class="p">[</span><span class="n">k</span><span class="p">])):</span> 
<span class="ln">131</span>                <span class="n">found</span> <span class="o">=</span> <span class="mi">0</span>
<span class="ln">132</span>                <span class="n">person_idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="ln">133</span>                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">personwiseKeypoints</span><span class="p">)):</span>
<span class="ln">134</span>                    <span class="k">if</span> <span class="n">personwiseKeypoints</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">indexA</span><span class="p">]</span> <span class="o">==</span> <span class="n">partAs</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
<span class="ln">135</span>                        <span class="n">person_idx</span> <span class="o">=</span> <span class="n">j</span>
<span class="ln">136</span>                        <span class="n">found</span> <span class="o">=</span> <span class="mi">1</span>
<span class="ln">137</span>                        <span class="k">break</span>
<span class="ln">138</span>
<span class="ln">139</span>                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
<span class="ln">140</span>                    <span class="n">personwiseKeypoints</span><span class="p">[</span><span class="n">person_idx</span><span class="p">][</span><span class="n">indexB</span><span class="p">]</span> <span class="o">=</span> <span class="n">partBs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="ln">141</span>                    <span class="n">personwiseKeypoints</span><span class="p">[</span><span class="n">person_idx</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">keypoints_list</span><span class="p">[</span><span class="n">partBs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">valid_pairs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<span class="ln">142</span>
<span class="ln">143</span>                <span class="c1"># if find no partA in the subset, create a new subset</span>
<span class="ln">144</span>                <span class="k">elif</span> <span class="ow">not</span> <span class="n">found</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">17</span><span class="p">:</span>
<span class="ln">145</span>                    <span class="n">row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="ln">146</span>                    <span class="n">row</span><span class="p">[</span><span class="n">indexA</span><span class="p">]</span> <span class="o">=</span> <span class="n">partAs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="ln">147</span>                    <span class="n">row</span><span class="p">[</span><span class="n">indexB</span><span class="p">]</span> <span class="o">=</span> <span class="n">partBs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="ln">148</span>                    <span class="c1"># add the keypoint_scores for the two keypoints and the paf_score </span>
<span class="ln">149</span>                    <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">keypoints_list</span><span class="p">[</span><span class="n">valid_pairs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">,:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">valid_pairs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<span class="ln">150</span>                    <span class="n">personwiseKeypoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">personwiseKeypoints</span><span class="p">,</span> <span class="n">row</span><span class="p">])</span>
<span class="ln">151</span>    <span class="k">return</span> <span class="n">personwiseKeypoints</span>
<span class="ln">152</span>
<span class="ln">153</span><span class="n">valid_pairs</span><span class="p">,</span> <span class="n">invalid_pairs</span> <span class="o">=</span> <span class="n">getValidPairs</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="ln">154</span>
<span class="ln">155</span><span class="n">personwiseKeypoints</span> <span class="o">=</span> <span class="n">getPersonwiseKeypoints</span><span class="p">(</span><span class="n">valid_pairs</span><span class="p">,</span> <span class="n">invalid_pairs</span><span class="p">)</span>
<span class="ln">156</span>
<span class="ln">157</span>
<span class="ln">158</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nPoints</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
<span class="ln">159</span>    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">personwiseKeypoints</span><span class="p">)):</span>
<span class="ln">160</span>       
<span class="ln">161</span>        <span class="n">index</span> <span class="o">=</span> <span class="n">personwiseKeypoints</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">POSE_PAIRS</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span>
<span class="ln">162</span>        <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
<span class="ln">163</span>            <span class="k">continue</span>
<span class="ln">164</span>        <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">keypoints_list</span><span class="p">[</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>
<span class="ln">165</span>        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">keypoints_list</span><span class="p">[</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="mi">1</span><span class="p">])</span>
<span class="ln">166</span>        <span class="n">cv2</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">frameClone</span><span class="p">,</span> <span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">LINE_AA</span><span class="p">)</span>
<span class="ln">167</span>       
<span class="ln">168</span>        
<span class="ln">169</span>        
<span class="ln">170</span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">frameClone</span><span class="p">)</span>
<span class="ln">171</span>    <span class="c1"># plt.imshow(mapMask, alpha=0.5)</span>
<span class="ln">172</span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div><p><img class="img-fluid" alt="Hình kết quả cuối cùng" src="/blog/2018-10-05-deep-learning-base-multiple-human-pose-estimation/multiple_pose_estimation_t-ara_finalresult.jpg" loading="lazy"
  
   />

</p>
<p>Hẹn gặp lại các bạn ở những bài viết tiếp theo.</p>
<p>Bài viết này được viết dựa vào nguồn <a href="https://www.learnopencv.com/multi-person-pose-estimation-in-opencv-using-openpose/" target="_blank" rel="noopener noreferrer">https://www.learnopencv.com/multi-person-pose-estimation-in-opencv-using-openpose/</a> của tác giả VIKAS GUPTA. Tôi sử dụng tập model và hình ảnh khác với bài viết nguyên gốc của tác giả.</p>
</div></div>
  <div class="card-footer"><div class="post-navs d-flex justify-content-evenly"><div class="post-nav post-prev">
    <i class="fas fa-fw fa-chevron-left"></i>
    <a href="/blog/2018-10-04-deep-learning-base-human-pose-estimation/">Deep Learning Based Human Pose Estimation Using OpenCV
</a>
  </div><div class="post-nav post-next">
    <a href="/blog/2018-10-08-mask-rnn/">Mask R-CNN Trong Bài Toán Nhận Dạng Và Phân Vùng Đối Tượng
</a>
    <i class="fas fa-fw fa-chevron-right"></i>
  </div></div></div>
</article><div class="card component row post-comments" id="post-comments">
  <div class="card-header">
    <h2 class="card-title">Comments</h2>
  </div>
  <div class="card-body"><script src="https://utteranc.es/client.js"
  repo="AlexBlack2202/utterances"
  issue-term="pathname"
  label="comment"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script></div>
</div></div>
</div><aside class="col-lg-4 sidebar d-flex">
  <div class="container d-flex flex-column">
    
    <section class="card row text-center profile component">
  <div class="card-body">
    <div class="col-12 d-flex align-items-center justify-content-center"><img class="profile-avatar rounded-circle" alt="Đặng Thị Hằng | Phạm Duy Tùng" src="/images/profile.webp" loading="lazy"
   width="736" height="920"
   />
</div>
    <div class="col-12 profile-meta"><div class="profile-name">Đặng Thị Hằng | Phạm Duy Tùng</div><div class="profile-bio">Gopher, CShaper, Pythoner, Full Stack Engineer.</div><div class="profile-company"><i class="fas fa-fw fa-building"></i>MWG</div><div class="profile-location"><i class="fas fa-fw fa-map-marker-alt"></i>Earth</div><div class="profile-about"><i class="fas fa-fw fa-user"></i><a href="/about/">About</a></div><div class="profile-contact"><i class="fas fa-fw fa-question-circle"></i><a href="/contact/">Contact Us</a></div>
</div>
  </div>
</section>
  <div class="post-toc row mb-4 card component" id="postTOC">
  <div class="card-header">
    <h2 class="card-title">Contents</h2>
  </div>
  <div class="card-body">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#lời-mở-đầu">Lời mở đầu</a></li>
    <li><a href="#sử-dụng-pretrain-model-trong-bài-toán-multiple-pose-estimation">Sử dụng pretrain model trong bài toán multiple Pose Estimation</a></li>
  </ul>
</nav>
  </div>
</div><section class="recent-posts row card component">
  <div class="card-header">
    <h2 class="card-title">Recent Posts</h2>
  </div>
  <div class="card-body">
    <ul class="post-list"><li>
        <a href="/blog/2022-02-25-normalization/">Các Kỹ Thuật Chuẩn Hóa Trong Deep Learning
</a>
      </li><li>
        <a href="/blog/2021-11-06-some-way-make-momey-from-web-scrapping/">Một Số Cách Kiếm Thêm Thu Nhập Từ Cách Cào Dữ Liệu
</a>
      </li><li>
        <a href="/blog/2021-08-12-china_chess_alpha_beta_ai/">Xây Dựng Chương Trình AI Đơn Giản Cho Game Cờ Tướng
</a>
      </li><li>
        <a href="/blog/2021-07-28-pycaret-flaskapi/">Tìm Hiểu Package PyCaret Trong Python
</a>
      </li><li>
        <a href="/blog/2021-07-02-mo-hinh-phan-quyen/">Mô Hình Phân Quyền - Access Control
</a>
      </li></ul>
  </div>
</section><section class="series-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/series">Series</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/series/kh%C3%B3a-h%E1%BB%8Dc-c&#43;&#43;-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Khóa học c&#43;&#43; căn bản">
            Khóa học c&#43;&#43; căn bản<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/series/machine-learning-dataset/" class="badge rounded post-taxonomy" title="Machine learning dataset">
            Machine learning dataset<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/series/ch%E1%BB%A9ng-kho%C3%A1n-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Chứng khoán căn bản">
            Chứng khoán căn bản<span class="badge badge-sm text-white bg-accent ms-1">1</span></a><a href="/series/kh%C3%B3a-h%E1%BB%8Dc-python-c%C4%83n-b%E1%BA%A3n/" class="badge rounded post-taxonomy" title="Khóa học python căn bản">
            Khóa học python căn bản<span class="badge badge-sm text-white bg-accent ms-1">1</span></a></div>
      </div>
    </section><section class="categories-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/categories">Categories</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/categories/c&#43;&#43;/" class="badge rounded post-taxonomy" title="c&#43;&#43;">
            c&#43;&#43;<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/categories/dataset/" class="badge rounded post-taxonomy" title="dataset">
            dataset<span class="badge badge-sm text-white bg-accent ms-1">2</span></a><a href="/categories/python/" class="badge rounded post-taxonomy" title="python">
            python<span class="badge badge-sm text-white bg-accent ms-1">1</span></a></div>
      </div>
    </section><section class="tags-taxonomies row card component">
      <div class="card-header">
        <h2 class="card-title">
          <a href="/tags">Tags</a>
        </h2>
      </div>
      <div class="card-body">
        <div class="py-2"><a href="/tags/machine-learning/" class="badge rounded post-taxonomy" title="Machine learning">
            Machine learning<span class="badge badge-sm text-white bg-accent ms-1">39</span></a><a href="/tags/deeplearning/" class="badge rounded post-taxonomy" title="Deeplearning">
            Deeplearning<span class="badge badge-sm text-white bg-accent ms-1">20</span></a><a href="/tags/deep-learning/" class="badge rounded post-taxonomy" title="Deep learning">
            Deep learning<span class="badge badge-sm text-white bg-accent ms-1">16</span></a><a href="/tags/python/" class="badge rounded post-taxonomy" title="python">
            python<span class="badge badge-sm text-white bg-accent ms-1">10</span></a><a href="/tags/opencv/" class="badge rounded post-taxonomy" title="opencv">
            opencv<span class="badge badge-sm text-white bg-accent ms-1">5</span></a><a href="/tags/c&#43;&#43;/" class="badge rounded post-taxonomy" title="c&#43;&#43;">
            c&#43;&#43;<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/tags/object-detector/" class="badge rounded post-taxonomy" title="object detector">
            object detector<span class="badge badge-sm text-white bg-accent ms-1">4</span></a><a href="/tags/alexnet/" class="badge rounded post-taxonomy" title="AlexNet">
            AlexNet<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/tags/d%E1%BB%B1-%C4%91o%C3%A1n/" class="badge rounded post-taxonomy" title="dự đoán">
            dự đoán<span class="badge badge-sm text-white bg-accent ms-1">3</span></a><a href="/tags/forecast/" class="badge rounded post-taxonomy" title="forecast">
            forecast<span class="badge badge-sm text-white bg-accent ms-1">3</span></a></div>
      </div>
    </section>
    
  </div>
</aside>
</div>
    </main><footer class="footer mt-auto py-3 text-center container"><ul class="nav justify-content-between footer-memu mb-3"><li class="nav-item"><ul class="nav flex-column align-items-start">
      <li class="nav-item">
        <a class="nav-link fw-bold" target="_blank" rel="noopener noreferrer">Support
</a>
      </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer"><i class="fab fa-fw fa-github"></i>Repository
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer"><i class="fas fa-fw fa-comments"></i>Discussions
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">Features Request
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">Bug Report
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="/contact/"><i class="fas fa-fw fa-info-circle"></i>Contact Us
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="/faq/"><i class="fas fa-fw fa-question-circle"></i>FAQs
</a>
        </li></ul></li><li class="nav-item"><li class="nav-item">
      <a class="nav-link" target="_blank" rel="noopener noreferrer">Docs
</a>
    </li></li><li class="nav-item"><li class="nav-item">
      <a class="nav-link" target="_blank" rel="noopener noreferrer">Features
</a>
    </li></li><li class="nav-item"><ul class="nav flex-column align-items-start">
      <li class="nav-item">
        <a class="nav-link fw-bold" target="_blank" rel="noopener noreferrer">Demo
</a>
      </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">Netlify
</a>
        </li><li class="nav-item">
            <a class="nav-link" href="https://www.facebook.com/groups/1354425091720104" target="_blank" rel="noopener noreferrer">China
</a>
        </li></ul></li></ul>
<div class="copyright mb-2">
  Copyright © 2016-2022 Phạm Duy Tùng. All Rights Reserved.
</div>
<div class="powered-by mb-2">
  Website chia sẻ kiến thức của Phạm Duy Tùng và Đặng Thị Hằng. Vui lòng liên hệ email alexblack2202@gmail.com nếu bạn có thông tin cần trao đổi.
</div></footer>
<script src="/js/main.0f06b653e090cf5f3e595cc4f3150328397d377ee5b405d0803057801eb4f3e5.js" integrity="sha256-Dwa2U&#43;CQz18&#43;WVzE8xUDKDl9N37ltAXQgDBXgB608&#43;U=" crossorigin="anonymous" defer></script><script src="/js/icons.min.8ddcaafc364ff0296c2209c5495287f0de039b852da9b24847f94c198b7639b6.js" integrity="sha256-jdyq/DZP8ClsIgnFSVKH8N4Dm4UtqbJIR/lMGYt2ObY=" crossorigin="anonymous" defer></script>
<script>
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('\/service-worker.js').then(function(reg) {
      console.log('Successfully registered service worker', reg);
    }).catch(function(err) {
      console.warn('Error whilst registering service worker', err);
    });
  });
}
</script><script src="/js/viewer.min.652118a9fbf3403cdfde4026209f97ace22f9e334f0b45a33431a221b3db46a8.js" integrity="sha256-ZSEYqfvzQDzf3kAmIJ&#43;XrOIvnjNPC0WjNDGiIbPbRqg=" crossorigin="anonymous" defer></script><script defer src="/js/katex.min.a575e93a07f02f7e58ee9002aea3b4e75163d4fa8ea3a627e90e7fafd5c718fa.js" integrity="sha256-pXXpOgfwL35Y7pACrqO051Fj1PqOo6Yn6Q5/r9XHGPo=" crossorigin="anonymous"></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-114911596-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>
